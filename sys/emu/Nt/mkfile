SYSTARG=Nt
OBJTYPE=386
#uncomment following line for full Microsoft debug symbols
#LDEBUG=-debug -debugtype:cv -pdb:none
<../../mkconfig
SYSTARG=Nt
OBJTYPE=386

#Configurable parameters

CONF=emu			#default configuration
CONFLIST=emu
CLEANCONFLIST=

INSTALLDIR=../../$SYSTARG/$OBJTYPE/bin	#path of directory where kernel is installed

#end configurable parameters

OSX=os
WINX=win

<| sh ../port/mkdevlist < $CONF	#sets $IP, $DEVS, $PORT, $LIBS

OBJ=\
	$OSX.$O\
	$WINX.$O\
	$CONF.root.$O\
	lock.$O\
	fp.$O\
	vlrt.$O\
	$DEVS\
	$PORT\

HFILES=\

CFLAGS=  -DEMU -I. -I../port -I../../$SYSTARG/$OBJTYPE/include -I../../include -I../../libinterp $CTHREADFLAGS $CFLAGS $EMUOPTIONS
#SYSLIBS=	$SYSLIBS 
#wsock32.lib user32.lib gdi32.lib advapi32.lib winmm.lib mpr.lib
KERNDATE=`{$NDATE}

default:V:	i$CONF.exe

<../port/portmkfile

i$CONF.exe:	$OBJ $CONF.c $CONF.root.h $LIBFILES
	$LD $target   $OBJ $CONF.$O $LIBFILES $SYSLIBS

$CONF.obj: $CONF.c
	$CC $CFLAGS '-DKERNDATE='$KERNDATE $CONF.c

install:V: i$CONF.exe
	mv /Acme.exe /Acme-bak.exe
	cp i$CONF.exe /Acme.exe
